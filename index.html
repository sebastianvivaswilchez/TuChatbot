<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TuChatbot | Automatiza tus conversaciones con IA</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <style>
    body {
      background-color: #0B0B0F;
      color: #F5F6F7;
      font-family: 'Inter', sans-serif;
    }
    .gradient-text {
      background: linear-gradient(90deg, #8B5CF6, #06B6D4);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .btn-primary {
      background: linear-gradient(90deg, #3B82F6, #06B6D4);
      color: white;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .btn-primary:hover {
      filter: brightness(1.2);
    }
    .btn-light {
      background-color: #F5F6F7;
      color: #0B0B0F;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    .btn-light:hover {
      background-color: #E2E8F0;
    }
    .section-bg {
      background-color: #111114;
    }
    .card-highlight {
      background: radial-gradient(circle at top left, #1E1E2A, #15151D);
      border: 1px solid rgba(139, 92, 246, 0.3);
      box-shadow: 0 0 20px rgba(139, 92, 246, 0.15);
    }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <header class="sticky top-0 z-30 bg-[#0B0B0F]/90 backdrop-blur border-b border-gray-800">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <h1 class="text-lg font-semibold tracking-tight">TuChatbot</h1>
      <nav class="hidden md:flex items-center gap-8 text-sm text-gray-300">
        <a href="#beneficios" class="hover:text-white transition">Beneficios</a>
        <a href="#funciona" class="hover:text-white transition">C√≥mo funciona</a>
        <a href="#planes" class="hover:text-white transition">Planes</a>
        <a href="#prueba" class="hover:text-white transition">Prueba gratis</a>
      </nav>
      <a href="#prueba" class="px-5 py-2 rounded-full text-sm btn-primary shadow-md">Prueba gratis 3 d√≠as</a>
    </div>
  </header>

  <!-- HERO -->
  <section class="max-w-7xl mx-auto px-6 py-20 grid md:grid-cols-2 gap-12 items-center">
    <!-- Columna izquierda -->
    <div>
      <h2 class="text-4xl md:text-5xl font-bold mb-5 leading-tight">
        Tu <span class="gradient-text">Chatbot con IA</span> que vende y atiende 24/7 por WhatsApp
      </h2>
      <p class="text-gray-400 mb-6 max-w-lg text-base md:text-lg">
        Responde como t√∫, captura datos de tus conversaciones y agenda citas autom√°ticamente. Todo personalizado con tu voz y tu estilo.
      </p>
      <div class="flex flex-wrap gap-4 mb-4">
        <a href="#prueba" class="px-6 py-3 rounded-full btn-primary text-sm">Prueba gratis 3 d√≠as</a>
        <a href="#" id="heroWhatsAppBtn" class="px-6 py-3 rounded-full border border-blue-500 text-blue-400 text-sm font-semibold hover:bg-blue-500 hover:text-white transition">
          Hablemos por WhatsApp
        </a>
      </div>
      <p class="text-xs text-gray-500">Tu Chatbot personalizado con Inteligencia Artificial</p>
    </div>

    <!-- CHAT HERO -->
    <div>
      <div class="bg-gradient-to-r from-[#8B5CF6] to-[#06B6D4] rounded-3xl p-5 md:p-6 shadow-[0_20px_60px_rgba(15,23,42,0.9)]">
        <div class="flex justify-between items-center mb-4">
          <div>
            <p class="text-[10px] sm:text-xs md:text-sm text-slate-100">Demo en directo</p>
            <p class="text-[11px] sm:text-xs md:text-sm font-semibold text-white">
              Prueba la Inteligencia Artificial en acci√≥n
            </p>
          </div>
          <span class="text-[9px] sm:text-[10px] md:text-[11px] px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-100 border border-emerald-400/60 flex items-center gap-1">
            <span class="w-2 h-2 rounded-full bg-emerald-300 animate-pulse"></span> En vivo
          </span>
        </div>

        <div class="bg-slate-950/80 border border-slate-800 rounded-2xl p-4 flex flex-col h-80">
          <!-- Mensajes -->
          <div id="chatbox" class="flex-1 space-y-3 overflow-y-auto pr-1 text-xs md:text-sm"></div>

          <!-- Input -->
          <form id="chatForm" class="mt-4 flex items-center gap-2">
            <input
              id="chatInput"
              type="text"
              autocomplete="off"
              placeholder="Escribe tu respuesta..."
              class="flex-1 px-3 py-2 rounded-full bg-slate-900 border border-slate-700 text-xs md:text-sm text-slate-100 placeholder-slate-300 focus:outline-none focus:ring-2 focus:ring-blue-500"
            />
            <button
              type="submit"
              class="flex items-center justify-center w-10 h-10 rounded-full bg-blue-600 hover:bg-blue-500 text-sm shadow-md">
              ‚úà
            </button>
          </form>
        </div>

        <p class="mt-3 text-[10px] sm:text-[11px] text-slate-200">
          Este chat es una demo. Tus datos solo se usan para mostrar c√≥mo TuChatbot puede capturar contacto
          y calificar interesados de forma autom√°tica.
        </p>
      </div>
    </div>
  </section>

  <!-- BENEFICIOS -->
  <section id="beneficios" class="py-20 border-t border-gray-800 section-bg text-center">
    <div class="max-w-6xl mx-auto px-6">
      <h3 class="text-3xl font-semibold mb-12">Beneficios de usar <span class="gradient-text">TuChatbot</span></h3>
      <div class="grid md:grid-cols-3 gap-8">
        <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
          <h4 class="text-lg font-semibold mb-2">üöÄ Ahorra tiempo</h4>
          <p class="text-gray-400 text-sm">Responde autom√°ticamente 24/7 y olv√≠date de las tareas repetitivas.</p>
        </div>
        <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
          <h4 class="text-lg font-semibold mb-2">ü§ñ Habla como t√∫</h4>
          <p class="text-gray-400 text-sm">Entrena tu Chatbot con tu tono, estilo y respuestas personalizadas.</p>
        </div>
        <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
          <h4 class="text-lg font-semibold mb-2">üí° Convierte m√°s</h4>
          <p class="text-gray-400 text-sm">Capta leads y agenda reuniones autom√°ticamente sin perder oportunidades.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- C√ìMO FUNCIONA -->
  <section id="funciona" class="py-20 border-t border-gray-800 section-bg">
    <div class="max-w-6xl mx-auto px-6 text-center">
      <h3 class="text-3xl font-semibold mb-4">C√≥mo funciona <span class="gradient-text">TuChatbot</span></h3>
      <p class="text-gray-400 mb-12">En lugar de responder uno a uno, dejas que TuChatbot haga el trabajo por ti: responde, filtra, captura y te entrega las mejores oportunidades listas para cerrar.</p>
      <div class="grid md:grid-cols-3 gap-8 text-left text-gray-300">
        <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
          <h4 class="text-blue-400 font-semibold mb-2">Paso 1</h4>
          <h5 class="font-semibold mb-2">Configura tu voz y tu oferta</h5>
          <p>Cargamos la informaci√≥n clave de tu marca, tus servicios y tu forma de comunicar para que TuChatbot hable como t√∫.</p>
        </div>
        <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
          <h4 class="text-blue-400 font-semibold mb-2">Paso 2</h4>
          <h5 class="font-semibold mb-2">TuChatbot responde y filtra</h5>
          <p>Cuando alguien escribe, TuChatbot responde, identifica inter√©s real y pide los datos necesarios (WhatsApp y correo).</p>
        </div>
        <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
          <h4 class="text-blue-400 font-semibold mb-2">Paso 3</h4>
          <h5 class="font-semibold mb-2">Recibes leads listos para accionar</h5>
          <p>Te llegan contactos ya filtrados y con contexto para que puedas agendar, enviar propuesta o continuar la conversaci√≥n.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- COMPARATIVA -->
  <section class="py-20 section-bg border-t border-gray-800">
    <div class="max-w-6xl mx-auto px-6 grid md:grid-cols-2 gap-8">
      <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
        <h4 class="font-semibold mb-4">Con TuChatbot</h4>
        <ul class="space-y-2 text-gray-300 text-sm">
          <li>‚úÖ IA entrenada en tu tono: habla como tu marca</li>
          <li>‚úÖ Conecta WhatsApp y responde 24/7</li>
          <li>‚úÖ Guarda leads en Sheets (nombre, apellido, tel√©fono, email)</li>
          <li>‚úÖ Memoria conversacional por sesi√≥n</li>
          <li>‚úÖ Soporte directo por WhatsApp</li>
        </ul>
      </div>
      <div class="bg-[#18181F] p-6 rounded-2xl border border-gray-800">
        <h4 class="font-semibold mb-4">Sin TuChatbot</h4>
        <ul class="space-y-2 text-gray-300 text-sm">
          <li>‚ùå Respuestas tard√≠as o inconsistentes</li>
          <li>‚ùå Leads sin datos ordenados ni seguimiento</li>
          <li>‚ùå Sin trazabilidad en las conversaciones</li>
          <li>‚ùå Mensajes que suenan a robot o muy gen√©ricos</li>
          <li>‚ùå Tiempo perdido en tareas repetitivas</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- PLANES -->
  <section id="planes" class="py-20 border-t border-gray-800">
    <div class="max-w-6xl mx-auto px-6 text-center">
      <h3 class="text-3xl font-semibold mb-10">Elige tu plan</h3>
      <div class="grid md:grid-cols-2 gap-8">
        <div class="bg-[#18181F] p-8 rounded-2xl border border-gray-800">
          <p class="text-gray-400 mb-2">Desde 170‚Ç¨/mes</p>
          <h4 class="text-xl font-semibold mb-4">Plan Personal</h4>
          <p class="text-gray-400 mb-6">Ideal para freelancers o marcas personales.</p>
          <ul class="text-left space-y-2 text-sm text-gray-300 mb-6">
            <li>‚úÖ 1 Asistente Virtual IA con voz personal</li>
            <li>‚úÖ Conecta 1 cuenta de WhatsApp</li>
            <li>‚úÖ 300 conversaciones completas al mes</li>
            <li>‚úÖ Memoria conversacional</li>
            <li>‚úÖ Soporte por WhatsApp</li>
          </ul>
          <a href="#prueba" class="btn-primary px-6 py-3 rounded-full inline-block">Prueba gratis 3 d√≠as</a>
        </div>
        <div class="bg-[#18181F] p-8 rounded-2xl border border-gray-800">
          <p class="text-gray-400 mb-2">Desde 230‚Ç¨/mes</p>
          <h4 class="text-xl font-semibold mb-4">Plan para Negocio</h4>
          <p class="text-gray-400 mb-6">Para empresas que quieren convertir m√°s y crecer.</p>
          <ul class="text-left space-y-2 text-sm text-gray-300 mb-6">
            <li>‚úÖ 1 Asistente Virtual IA con voz de tu marca</li>
            <li>‚úÖ Conecta 1 cuenta de WhatsApp</li>
            <li>‚úÖ 500 conversaciones completas al mes</li>
            <li>‚úÖ Guarda datos en Sheets (nombre, apellido, tel√©fono, email)</li>
            <li>‚úÖ Agenda citas</li>
            <li>‚úÖ Memoria conversacional</li>
            <li>‚úÖ Soporte por WhatsApp</li>
          </ul>
          <a href="#prueba" class="btn-primary px-6 py-3 rounded-full inline-block">Prueba gratis 3 d√≠as</a>
        </div>
      </div>
    </div>
  </section>

  <!-- FORMULARIO -->
  <section id="prueba" class="py-20 border-t border-gray-800 section-bg">
    <div class="max-w-4xl mx-auto px-6">
      <h3 class="text-3xl font-semibold text-center mb-8">Prueba gratis 3 d√≠as</h3>
      <p class="text-center text-gray-400 mb-8">D√©janos tus datos y te contactamos para activar tu prueba.</p>
      <form id="leadForm" class="grid md:grid-cols-2 gap-6 text-sm">
        <div>
          <label class="block mb-2 text-gray-400">Nombre</label>
          <input
            id="formNombre"
            name="nombre"
            type="text"
            placeholder="Tu nombre"
            class="w-full p-3 rounded-lg bg-[#18181F] border border-gray-700 text-slate-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        <div>
          <label class="block mb-2 text-gray-400">Apellido</label>
          <input
            id="formApellido"
            name="apellido"
            type="text"
            placeholder="Tu apellido"
            class="w-full p-3 rounded-lg bg-[#18181F] border border-gray-700 text-slate-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        <div>
          <label class="block mb-2 text-gray-400">Email</label>
          <input
            id="formEmail"
            name="email"
            type="email"
            placeholder="tu@email.com"
            class="w-full p-3 rounded-lg bg-[#18181F] border border-gray-700 text-slate-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        <div>
          <label class="block mb-2 text-gray-400">Tel√©fono (con indicativo pa√≠s)</label>
          <input
            id="formTelefono"
            name="telefono"
            type="tel"
            placeholder="+34 603 93 86 59"
            class="w-full p-3 rounded-lg bg-[#18181F] border border-gray-700 text-slate-100 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
          />
        </div>
        <div class="md:col-span-2 text-center mt-4">
          <button type="submit" class="btn-primary px-8 py-3 rounded-full">
            Prueba gratis 3 d√≠as
          </button>
          <p class="text-xs text-gray-500 mt-3">Al enviar aceptas nuestra Pol√≠tica de Privacidad.</p>
        </div>
      </form>
    </div>
  </section>

  <!-- USO PERSONAL -->
  <section class="py-20 border-t border-gray-800">
    <div class="max-w-6xl mx-auto px-6 grid md:grid-cols-2 gap-12">
      <div>
        <h3 class="text-2xl font-semibold mb-4">Para uso personal y marca propia</h3>
        <p class="text-gray-400 mb-4">
          Si tienes una marca personal, eres creador de contenido, freelance o profesional independiente, TuChatbot se convierte en tu filtro inteligente.
        </p>
        <ul class="list-disc ml-6 text-gray-400 space-y-2 text-sm">
          <li>Responde dudas frecuentes mientras t√∫ trabajas, creas o descansas.</li>
          <li>Env√≠a enlaces a tu portafolio, agenda, formulario o recursos.</li>
          <li>Guarda los datos de los contactos interesados para que les escribas despu√©s.</li>
        </ul>
      </div>
      <div class="card-highlight p-6 rounded-2xl text-gray-300">
        <h4 class="text-gray-400 mb-2">Ejemplo realista</h4>
        <p>
          ‚ÄúRecibo mensajes a todas horas pidiendo informaci√≥n y no siempre puedo responder.
          TuChatbot responde por m√≠, manda la info correcta y me deja los leads calientes listos para escribirles m√°s tarde.‚Äù
        </p>
      </div>
    </div>

    <div class="max-w-6xl mx-auto px-6 grid md:grid-cols-2 gap-12 mt-20">
      <div>
        <h3 class="text-2xl font-semibold mb-4">Para equipos y empresas</h3>
        <p class="text-gray-400 mb-4">
          Convierte TuChatbot en el primer punto de contacto de tu negocio: contesta, educa al cliente y deriva a la persona o canal correcto.
        </p>
        <ul class="list-disc ml-6 text-gray-400 space-y-2 text-sm">
          <li>Reduce carga en tu equipo de atenci√≥n o setters.</li>
          <li>Estandariza respuestas y procesos de informaci√≥n.</li>
          <li>Integra con tus herramientas (CRM, Sheets, automatizaciones, etc.).</li>
        </ul>
      </div>
      <div class="card-highlight p-6 rounded-2xl text-gray-300">
        <h4 class="text-blue-400 mb-2">Resultado t√≠pico</h4>
        <p>
          ‚ÄúAntes ten√≠amos el WhatsApp saturado. Ahora TuChatbot responde lo b√°sico, captura datos y solo nos llegan las conversaciones que realmente vale la pena atender.‚Äù
        </p>
      </div>
    </div>
  </section>

  <!-- CTA FINAL -->
  <section class="py-20 text-center bg-gradient-to-r from-[#8B5CF6] to-[#06B6D4] text-white">
    <h3 class="text-2xl md:text-3xl font-semibold mb-4">Convierte TuChatbot en tu asistente 24/7</h3>
    <p class="max-w-2xl mx-auto mb-6 text-sm md:text-base opacity-90">
      Empieza con una prueba gratuita de 3 d√≠as y descubre c√≥mo puede transformar tu comunicaci√≥n y tus resultados.
    </p>
    <a href="#prueba" class="px-6 py-3 rounded-full btn-light text-sm">
      Empezar ahora ¬∑ Prueba gratis 3 d√≠as
    </a>
  </section>

  <footer class="py-8 text-center text-gray-500 text-xs border-t border-gray-800 bg-[#0B0B0F]">
    ¬© 2025 TuChatbot ‚Äî Tu asistente personalizado con Inteligencia Artificial.
  </footer>

  <!-- SCRIPT: Chat demo -->
  <script>
    const chatbox = document.getElementById('chatbox');
    const formChat = document.getElementById('chatForm');
    const chatInput = document.getElementById('chatInput');

    const lead = { phone: '', email: '' };
    let chatStep = 0;

    function addMsg(msg, sender) {
      if (!chatbox) return;
      const div = document.createElement('div');
      div.className = sender === 'bot' ? 'flex justify-start' : 'flex justify-end';

      const bubble = document.createElement('div');
      bubble.className = sender === 'bot'
        ? 'inline-block max-w-[80%] bg-slate-800 text-slate-100 px-3 py-2 rounded-2xl rounded-bl-sm text-xs md:text-sm'
        : 'inline-block max-w-[80%] bg-blue-600 text-white px-3 py-2 rounded-2xl rounded-br-sm text-xs md:text-sm';

      bubble.textContent = msg;
      div.appendChild(bubble);
      chatbox.appendChild(div);
      chatbox.scrollTop = chatbox.scrollHeight;
    }

    function isValidEmail(text) {
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      return emailRegex.test(text.trim());
    }

    function isValidPhone(text) {
      const digits = text.replace(/\D/g, '');
      return digits.length >= 7;
    }

    function isGreeting(text) {
      const greetings = ['hola', 'buenas', 'hey', 'hello', 'holi', 'qu√© tal', 'buen d√≠a', 'saludos'];
      const normalized = text.toLowerCase();
      return greetings.some(g => normalized.includes(g));
    }

    function isInterested(text) {
      const interest = [
        's√≠', 'si', 'claro', 'quiero', 'me interesa', 'c√≥mo funciona', 'funciona',
        'probar', 'saber m√°s', 'ok', 'vale', 'bueno', 'perfecto', 'de una',
        'dale', 'listo', 'obvio', 'por supuesto'
      ];
      const normalized = text.toLowerCase();
      return interest.some(i => normalized.includes(i));
    }

    // Mensaje inicial del chat
    if (chatbox) {
      addMsg('Hola üëã Soy TuChatbot. ¬øTe gustar√≠a saber c√≥mo funciona y probarlo gratis 3 d√≠as?', 'bot');
    }

    if (formChat && chatInput && chatbox) {
      formChat.addEventListener('submit', (e) => {
        e.preventDefault();
        const t = chatInput.value.trim();
        if (!t) return;

        addMsg(t, 'user');
        chatInput.value = '';

        if (chatStep === 0) {
          if (isGreeting(t) && !isInterested(t)) {
            setTimeout(() => {
              addMsg(
                'Encantado üòä Si quieres, puedo explicarte c√≥mo funciona TuChatbot y darte acceso a una prueba gratis. ¬øTe gustar√≠a saber m√°s?',
                'bot'
              );
            }, 400);
            return;
          }
          if (!isInterested(t)) {
            setTimeout(() => {
              addMsg(
                'Puedo explicarte c√≥mo funciona TuChatbot para uso personal o para tu empresa, y activar tu prueba gratuita. ¬øQuieres saber m√°s?',
                'bot'
              );
            }, 400);
            return;
          }

          chatStep = 1;
          setTimeout(() => {
            addMsg(
              'Perfecto üôå Para darte acceso a la prueba, dime tu n√∫mero de WhatsApp con prefijo de pa√≠s (por ejemplo: +34 603 93 86 59). ¬øCu√°l es el tuyo? üì±',
              'bot'
            );
          }, 400);

        } else if (chatStep === 1) {
          if (!isValidPhone(t)) {
            setTimeout(() => {
              addMsg(
                'Necesito un n√∫mero v√°lido con el formato correcto, incluyendo el prefijo de pa√≠s (ejemplo: +34 603 93 86 59). Int√©ntalo de nuevo, por favor.',
                'bot'
              );
            }, 400);
            return;
          }
          lead.phone = t.replace(/\D/g, '');
          chatStep = 2;
          setTimeout(() => {
            addMsg(
              'Genial üëç Ahora, ¬øcu√°l es tu correo electr√≥nico? (ejemplo: nombre@empresa.com)',
              'bot'
            );
          }, 400);

        } else if (chatStep === 2) {
          if (!isValidEmail(t)) {
            setTimeout(() => {
              addMsg(
                'Parece que ese correo no es v√°lido. Escr√≠belo de nuevo, por favor (ejemplo: tu@email.com).',
                'bot'
              );
            }, 400);
            return;
          }
          lead.email = t.trim();
          chatStep = 3;
          setTimeout(() => {
            addMsg(
              '¬°Listo! üéâ Gracias por tus datos üôå Podremos contactarte a los datos que nos diste para activar tu prueba gratis de TuChatbot. Si prefieres hacerlo ahora, tambi√©n puedes pulsar cualquier bot√≥n de ‚ÄúPrueba gratis 3 d√≠as‚Äù de la p√°gina.',
              'bot'
            );
          }, 400);
        }
      });
    }
  </script>

  <!-- SCRIPT: Webhook + WhatsApp -->
  <script>
    const N8N_WEBHOOK_URL = 'https://n8n-docker-233z.onrender.com/'; // Ajusta a tu webhook completo
    const WHATSAPP_PHONE = '34603938659'; // Tu n√∫mero sin '+'

    const MSG_WITH_DATA = 'Hola, vengo de la p√°gina de TuChatbot y me gustar√≠a probarlo gratis por 3 d√≠as.';
    const MSG_NO_DATA = 'Hola, vengo de la p√°gina de TuChatbot y quiero saber m√°s del bot con IA. ¬øMe das m√°s informaci√≥n?';

    function buildLeadPayload(source) {
      const payload = { source, createdAt: new Date().toISOString() };

      // Datos del chat
      try {
        if (typeof lead !== 'undefined') {
          if (lead.phone) payload.phone = lead.phone;
          if (lead.email) payload.email = lead.email;
        }
      } catch (e) {}

      // Datos del formulario
      const nombreInput = document.getElementById('formNombre');
      const apellidoInput = document.getElementById('formApellido');
      const emailInput = document.getElementById('formEmail');
      const telInput = document.getElementById('formTelefono');

      if (nombreInput && nombreInput.value.trim()) payload.nombre = nombreInput.value.trim();
      if (apellidoInput && apellidoInput.value.trim()) payload.apellido = apellidoInput.value.trim();
      if (emailInput && emailInput.value.trim()) payload.email = emailInput.value.trim();
      if (telInput && telInput.value.trim()) payload.phone = telInput.value.trim();

      return payload;
    }

    function payloadHasContact(payload) {
      return !!(payload.email || payload.phone);
    }

    async function sendLeadToWebhookIfAny(source) {
      const payload = buildLeadPayload(source);
      const hasData = payloadHasContact(payload);
      if (!hasData) {
        return { saved: false, hasData: false };
      }
      try {
        const res = await fetch(N8N_WEBHOOK_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });
        return { saved: res.ok, hasData: true };
      } catch (e) {
        console.error('Error enviando a n8n', e);
        return { saved: false, hasData: true };
      }
    }

    function openWhatsAppWithStatus(saved, hasData) {
      const text = saved && hasData ? MSG_WITH_DATA : MSG_NO_DATA;
      const url = 'https://wa.me/' + WHATSAPP_PHONE + '?text=' + encodeURIComponent(text);
      window.open(url, '_blank');
    }

    // Validaci√≥n y env√≠o del formulario
    const leadFormEl = document.getElementById('leadForm');
    if (leadFormEl) {
      leadFormEl.addEventListener('submit', async (e) => {
        e.preventDefault();

        const nombre = document.getElementById('formNombre')?.value.trim();
        const apellido = document.getElementById('formApellido')?.value.trim();
        const email = document.getElementById('formEmail')?.value.trim();
        const telefono = document.getElementById('formTelefono')?.value.trim();

        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const phoneRegex = /^\+?[0-9\s]{7,15}$/;

        if (!nombre || !apellido || !email || !telefono) {
          alert('Por favor completa todos los campos antes de continuar.');
          return;
        }

        if (!emailRegex.test(email)) {
          alert('Por favor ingresa un correo electr√≥nico v√°lido.');
          return;
        }

        if (!phoneRegex.test(telefono)) {
          alert('Por favor ingresa un n√∫mero de tel√©fono v√°lido con prefijo de pa√≠s.');
          return;
        }

        const result = await sendLeadToWebhookIfAny('form');
        // Aqu√≠ siempre hay datos (porque validamos), as√≠ que hasData es true
        openWhatsAppWithStatus(result.saved, true);
      });
    }

    // Bot√≥n ‚ÄúHablemos por WhatsApp‚Äù del hero
    const heroWaBtn = document.getElementById('heroWhatsAppBtn');
    if (heroWaBtn) {
      heroWaBtn.addEventListener('click', async (e) => {
        e.preventDefault();
        const result = await sendLeadToWebhookIfAny('hero-button');
        openWhatsAppWithStatus(result.saved, result.hasData);
      });
    }
  </script>
</body>
</html>
